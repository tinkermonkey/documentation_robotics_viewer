import{r as K,j as e}from"./iframe-DSSgKmXl.js";import{A as $}from"./AttributesTable-DaaEouFL.js";import{M as O}from"./MetadataGrid-_s-FIXyz.js";import{u as B}from"./annotationStore-C2enqPKJ.js";import{A as E,a as S,b as M,c as C}from"./AccordionTitle-Cun89kOD.js";import{B as V}from"./Badge-4uEMzFcW.js";const J=({model:u,specData:d,onPathHighlight:f,selectedLayer:o})=>{const{highlightedElementId:j}=B();if(K.useEffect(()=>{if(!j||!f)return;let c=null;for(const[a,s]of Object.entries(u.layers)){const t=s.elements||[],l=t.findIndex(m=>m.id===j);if(l!==-1){const m=t[l];c=`layers.${a}.elements[${l}] (${m.name||m.id})`;break}}c&&f(c)},[j,u,f]),!u)return e.jsx("div",{className:"w-full h-full flex items-center justify-center flex-col text-gray-500 dark:text-gray-400",children:e.jsx("p",{children:"No model data loaded"})});const x=u.layers||{},I=Object.keys(x).sort((c,a)=>{const s=x[c].order||999,t=x[a].order||999;return s-t}),T=(c,a)=>{if(!(d!=null&&d.schemas))return null;const s=Object.keys(d.schemas).find(l=>l.toLowerCase().includes(c.toLowerCase())&&l.includes("schema.json"));if(!s)return null;const t=d.schemas[s];if(t!=null&&t.definitions){if(t.definitions[a])return t.definitions[a];const l=Object.keys(t.definitions).find(m=>m.toLowerCase()===a.toLowerCase());if(l)return t.definitions[l]}return null},L=c=>{var s;if(!(d!=null&&d.schemas))return null;const a=Object.keys(d.schemas).find(t=>t.toLowerCase().includes(c.toLowerCase())&&t.includes("schema.json"));return a?(s=d.schemas[a])==null?void 0:s.description:null},R=()=>{var w;if(!o){const n=Object.values(x).reduce((y,p)=>{var r;return y+(((r=p.elements)==null?void 0:r.length)||0)},0),h=[{label:"Version",value:u.version},{label:"Total Elements",value:n},{label:"Total Layers",value:I.length},...(w=u.metadata)!=null&&w.loadedAt?[{label:"Loaded",value:new Date(u.metadata.loadedAt).toLocaleString()}]:[]];return e.jsx("div",{className:"h-full overflow-y-auto p-6",children:e.jsxs("div",{className:"flex items-center justify-center flex-col text-gray-400 dark:text-gray-500 mb-6",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Select a layer from the sidebar to view elements"}),e.jsx(O,{title:"Model Metadata",items:h,columns:2})]})})}const a=x[o]?o:Object.keys(x).find(n=>n.toLowerCase()===o.toLowerCase()),s=x[a||o];if(!s)return e.jsx("div",{className:"h-full overflow-y-auto p-6",children:e.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-white dark:bg-gray-900",children:e.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:["Layer not found: ",o]})})});const t=s.elements||[],l=t.reduce((n,h)=>{const y=h.type||"unknown";return n[y]||(n[y]=[]),n[y].push(h),n},{}),m=Object.keys(l).sort(),q=[{label:"Layer ID",value:s.id||a||o},{label:"Elements",value:t.length},{label:"Order",value:s.order}],N=L(o);return e.jsxs("div",{className:"h-full overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:s.name||a||o}),(s.description||N)&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 text-sm leading-relaxed",children:s.description||N}),e.jsx(O,{items:q,columns:3})]}),t.length===0?e.jsx("div",{className:"mt-6",children:e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-white dark:bg-gray-900",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No elements in this layer"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-2",children:"Elements will appear here when you add them to your model"})]})}):e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Elements (",t.length,")"]}),m.map(n=>{const h=l[n],y=`${o}-${n}`,p=T(o,n);return e.jsx(E,{collapseAll:!0,className:"mb-3",children:e.jsxs(S,{children:[e.jsx(M,{children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{className:"font-semibold",children:n}),e.jsx(V,{color:"gray",children:h.length})]})}),e.jsxs(C,{className:"bg-white dark:bg-gray-900",children:[p&&e.jsxs("div",{className:"mb-4 ml-4 pl-4 border-l-2 border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 rounded p-3",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Type Definition:"}),p.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:p.description}),p.properties&&e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{className:"text-gray-900 dark:text-white",children:"Properties:"}),e.jsx("ul",{className:"mt-2 space-y-1 ml-4",children:Object.entries(p.properties).map(([r,i])=>e.jsxs("li",{className:"text-gray-700 dark:text-gray-300",children:[e.jsx("code",{className:"bg-gray-200 dark:bg-gray-700 px-1 rounded",children:r}),i.type&&e.jsxs("span",{className:"text-gray-500",children:[" (",typeof i.type=="string"?i.type:i.type.join(" | "),")"]}),i.description&&e.jsxs("span",{children:[" - ",i.description]})]},r))})]})]}),e.jsx("div",{className:"space-y-3",children:h.map(r=>{var A;const i=[];r.id&&i.push({name:"ID",value:r.id}),r.name&&i.push({name:"Name",value:r.name}),r.type&&i.push({name:"Type",value:r.type});const v=(A=r.properties)==null?void 0:A.documentation,k=typeof v=="string"?v:void 0;return r.properties&&typeof r.properties=="object"&&Object.entries(r.properties).filter(([g])=>!["id","name","type","description","documentation"].includes(g)).forEach(([g,b])=>{i.push({name:g,value:b,isObject:typeof b=="object"&&b!==null})}),Object.entries(r).filter(([g])=>!["id","name","type","description","properties","visual","layerId"].includes(g)).forEach(([g,b])=>{i.push({name:g,value:b,isObject:typeof b=="object"&&b!==null})}),e.jsx(E,{collapseAll:!0,children:e.jsxs(S,{children:[e.jsx(M,{className:"text-sm",children:r.name||r.id}),e.jsx(C,{className:"bg-white dark:bg-gray-900",children:e.jsxs("div",{className:"space-y-4",children:[k&&e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsx("h6",{className:"text-xs font-semibold text-blue-900 dark:text-blue-300 mb-1 uppercase tracking-wide",children:"Documentation"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed whitespace-pre-wrap",children:k})]}),e.jsx($,{attributes:i,title:"Attributes"})]})})]})},r.id)})})]})]})},y)})]})]})};return e.jsx("div",{className:"h-full overflow-hidden",children:R()})};J.__docgenInfo={description:"",methods:[],displayName:"ModelJSONViewer",props:{model:{required:!0,tsType:{name:"MetaModel"},description:""},specData:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  schemas: Record<string, SchemaDefinition>;
}`,signature:{properties:[{key:"schemas",value:{name:"Record",elements:[{name:"string"},{name:"SchemaDefinition"}],raw:"Record<string, SchemaDefinition>",required:!0}}]}},description:""},onPathHighlight:{required:!1,tsType:{name:"signature",type:"function",raw:"(path: string | null) => void",signature:{arguments:[{type:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},name:"path"}],return:{name:"void"}}},description:""},selectedLayer:{required:!0,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""}}};export{J as M};
