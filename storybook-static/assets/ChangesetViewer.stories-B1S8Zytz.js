import{r as A,j as e}from"./iframe-DSSgKmXl.js";import{u as T}from"./changesetStore-Czqcwo7a.js";import{S as L}from"./Spinner-Al2eUyHo.js";import{C as n}from"./Card-dBO4-pIe.js";import{B as d}from"./Badge-4uEMzFcW.js";import"./preload-helper-Dp1pzeXC.js";import"./react-fqQoFC2C.js";import"./create-theme-BOkxhGns.js";const W=()=>{const{selectedChangeset:s,loading:I,error:g}=T(),O=A.useMemo(()=>{if(!s)return{};const t=s.changes.changes,r={};return t.forEach(l=>{r[l.layer]||(r[l.layer]=[]),r[l.layer].push(l)}),r},[s]),p=t=>new Date(t).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),E=t=>{const r={add:"success",update:"warning",delete:"failure"}[t.operation],l={add:"+",update:"~",delete:"âˆ’"}[t.operation];return e.jsxs("div",{className:"mb-3 last:mb-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(d,{color:r,size:"sm",children:[l," ",t.operation]}),e.jsx("code",{className:"text-xs bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:t.element_id}),e.jsx(d,{color:"gray",size:"sm",children:t.element_type}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-auto",children:p(t.timestamp)})]}),e.jsxs("div",{className:"pl-4 border-l-2 border-gray-200 dark:border-gray-700",children:[t.operation==="add"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-green-600 dark:text-green-400 mb-1",children:"Added:"}),e.jsx("pre",{className:"text-xs bg-green-50 dark:bg-green-900/20 p-2 rounded overflow-x-auto",children:JSON.stringify(t.data,null,2)})]}),t.operation==="update"&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-yellow-600 dark:text-yellow-400 mb-1",children:"Before:"}),e.jsx("pre",{className:"text-xs bg-yellow-50 dark:bg-yellow-900/20 p-2 rounded overflow-x-auto",children:JSON.stringify(t.before,null,2)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-yellow-600 dark:text-yellow-400 mb-1",children:"After:"}),e.jsx("pre",{className:"text-xs bg-yellow-50 dark:bg-yellow-900/20 p-2 rounded overflow-x-auto",children:JSON.stringify(t.after,null,2)})]})]}),t.operation==="delete"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-red-600 dark:text-red-400 mb-1",children:"Deleted:"}),e.jsx("pre",{className:"text-xs bg-red-50 dark:bg-red-900/20 p-2 rounded overflow-x-auto",children:JSON.stringify(t.before,null,2)})]})]})]},`${t.element_id}-${t.timestamp}`)};if(I)return e.jsx("div",{className:"flex-1 h-full overflow-y-auto bg-gray-50 dark:bg-gray-800 flex flex-col gap-4 p-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 gap-4",children:[e.jsx(L,{size:"lg"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading changeset..."})]})});if(g)return e.jsx("div",{className:"flex-1 h-full overflow-y-auto bg-gray-50 dark:bg-gray-800 flex flex-col gap-4 p-4",children:e.jsxs(n,{children:[e.jsx("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400",children:"Error"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:g})]})});if(!s)return e.jsx("div",{className:"flex-1 h-full overflow-y-auto bg-gray-50 dark:bg-gray-800 flex flex-col gap-4 p-4",children:e.jsx(n,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("span",{className:"text-4xl",children:"ðŸ“"}),e.jsx("p",{className:"mt-2 text-gray-500 dark:text-gray-400",children:"Select a changeset to view details"})]})})});const{metadata:a,changes:V}=s,h=V.changes.length;return e.jsxs("div",{className:"flex-1 h-full overflow-y-auto bg-gray-50 dark:bg-gray-800 flex flex-col gap-4 p-4",children:[e.jsxs(n,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.name}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{color:a.status==="active"?"success":a.status==="applied"?"info":"gray",children:a.status}),e.jsx(d,{color:"purple",children:a.type})]})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:a.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"ID:"}),e.jsx("code",{className:"ml-2 text-xs bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:a.id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Created:"}),e.jsx("span",{className:"ml-2 text-sm",children:p(a.created_at)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Updated:"}),e.jsx("span",{className:"ml-2 text-sm",children:p(a.updated_at)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Workflow:"}),e.jsx("span",{className:"ml-2 text-sm",children:a.workflow})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 dark:bg-green-900/20 rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:a.summary.elements_added}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Added"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:a.summary.elements_updated}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Updated"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 dark:bg-red-900/20 rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:a.summary.elements_deleted}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Deleted"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 dark:bg-blue-900/20 rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:h}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Total"})]})]})]}),e.jsxs("div",{className:"changeset-changes",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["Changes (",h,")"]}),Object.entries(O).map(([t,r])=>e.jsxs(n,{className:"mb-4",children:[e.jsxs("h4",{className:"text-base font-semibold text-gray-800 dark:text-gray-200 mb-3",children:[t," (",r.length,")"]}),e.jsx("div",{className:"space-y-3",children:r.map(E)})]},t))]})]})};W.__docgenInfo={description:"",methods:[],displayName:"ChangesetViewer"};const G={title:"A Primitives / Panels and Sidebars / ChangesetViewer",parameters:{layout:"centered"}},x=({initialState:s})=>(A.useEffect(()=>{T.setState(s)},[s]),e.jsx("div",{className:"w-full max-w-4xl p-4 bg-gray-50",children:e.jsx(W,{})})),Z={id:"cs-1",name:"Add User Authentication",type:"feature",status:"active",created_at:"2024-12-20T10:00:00Z",created_by:"Alice",description:"Implement OAuth2 authentication flow with token refresh",metadata:{id:"cs-1",name:"Add User Authentication",description:"Implement OAuth2 authentication flow with token refresh",type:"feature",status:"active",created_at:"2024-12-20T10:00:00Z",updated_at:"2024-12-20T15:30:00Z",workflow:"feature-workflow",summary:{elements_added:5,elements_updated:3,elements_deleted:1},version:"1.0",branch:"feature/auth"},changes:{version:"1.0",changes:[{id:"ch-1",operation:"add",timestamp:"2024-12-20T10:15:00Z",element_id:"auth-service",layer:"application-layer",elementId:"auth-service",elementType:"ApplicationComponent",element_type:"ApplicationComponent",elementName:"Authentication Service",properties:{technology:"Node.js",version:"1.0.0"}},{id:"ch-2",operation:"update",timestamp:"2024-12-20T10:30:00Z",element_id:"api-gateway",layer:"application-layer",elementId:"api-gateway",elementType:"ApplicationComponent",element_type:"ApplicationComponent",elementName:"API Gateway",properties:{security:"OAuth2"}},{id:"ch-3",operation:"delete",timestamp:"2024-12-20T10:45:00Z",element_id:"old-auth",layer:"application-layer",elementId:"old-auth",elementType:"ApplicationComponent",element_type:"ApplicationComponent",elementName:"Legacy Auth System"}]}},i={render:()=>e.jsx(x,{initialState:{selectedChangeset:Z,loading:!1,error:null}})},o={render:()=>e.jsx(x,{initialState:{selectedChangeset:null,loading:!0,error:null}})},c={render:()=>e.jsx(x,{initialState:{selectedChangeset:null,loading:!1,error:null}})},m={render:()=>e.jsx(x,{initialState:{selectedChangeset:null,loading:!1,error:"Failed to load changeset details"}})};var u,y,f;i.parameters={...i.parameters,docs:{...(u=i.parameters)==null?void 0:u.docs,source:{originalSource:`{
  render: () => <ChangesetViewerWrapper initialState={{
    selectedChangeset: mockChangeset,
    loading: false,
    error: null
  }} />
}`,...(f=(y=i.parameters)==null?void 0:y.docs)==null?void 0:f.source}}};var j,N,b;o.parameters={...o.parameters,docs:{...(j=o.parameters)==null?void 0:j.docs,source:{originalSource:`{
  render: () => <ChangesetViewerWrapper initialState={{
    selectedChangeset: null,
    loading: true,
    error: null
  }} />
}`,...(b=(N=o.parameters)==null?void 0:N.docs)==null?void 0:b.source}}};var v,w,k;c.parameters={...c.parameters,docs:{...(v=c.parameters)==null?void 0:v.docs,source:{originalSource:`{
  render: () => <ChangesetViewerWrapper initialState={{
    selectedChangeset: null,
    loading: false,
    error: null
  }} />
}`,...(k=(w=c.parameters)==null?void 0:w.docs)==null?void 0:k.source}}};var C,S,_;m.parameters={...m.parameters,docs:{...(C=m.parameters)==null?void 0:C.docs,source:{originalSource:`{
  render: () => <ChangesetViewerWrapper initialState={{
    selectedChangeset: null,
    loading: false,
    error: 'Failed to load changeset details'
  }} />
}`,...(_=(S=m.parameters)==null?void 0:S.docs)==null?void 0:_.source}}};const M=["WithChangeset","Loading","NoSelection","WithError"];export{o as Loading,c as NoSelection,i as WithChangeset,m as WithError,M as __namedExportsOrder,G as default};
