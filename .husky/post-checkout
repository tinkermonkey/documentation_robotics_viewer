#!/bin/bash

# Post-checkout hook: Sync API spec after branch switching
# Ensures spec is updated when checking out branches with different specs

# Bypass corrupted global git config if present
export GIT_CONFIG_GLOBAL=/dev/null
export GIT_CONFIG_SYSTEM=/dev/null

if git diff HEAD@{1}..HEAD --name-only 2>/dev/null | grep -q docs/api-spec.yaml; then
  echo "ðŸ”„ API spec changed. Syncing..."
  npm run sync:api-spec
  echo "âœ“ API spec synced"
fi

exit 0
