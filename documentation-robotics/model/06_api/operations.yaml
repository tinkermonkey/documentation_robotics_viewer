health-check:
  id: api.operation.health-check
  name: Health Check
  type: operation
  documentation: Returns server status and version information
  properties:
    method: GET
    path: /health
    description: Returns server status and version
    responses:
      "200":
        description: Server is healthy
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                version:
                  type: string
    x-archimate-ref:
      - application.service.reference-server
    x-protected-by:
      - security.permission.access-api-endpoints
    x-response-schema:
      - data-model.object-schema.health-check-response
    source:
      reference:
        provenance: manual
        locations:
          - file: server/index.cjs
            symbol: healthCheckHandler
get-spec:
  id: api.operation.get-spec
  name: Get Specification
  type: operation
  documentation: Returns the current JSON Schema specification
  properties:
    method: GET
    path: /api/spec
    description: Returns the current JSON Schema specification
    responses:
      "200":
        description: Specification data
      "404":
        description: Schema directory not found
    x-archimate-ref:
      - application.service.json-schema-parser
    x-protected-by:
      - security.permission.read-model-files
      - security.countermeasure.path-validation
    x-response-schema:
      - data_model.object-schema.spec-collection
    source:
      reference:
        provenance: manual
        locations:
          - file: server/index.cjs
            symbol: getSpecHandler
get-model:
  id: api.operation.get-model
  name: Get Model
  type: operation
  documentation: Returns the current model in viewer-compatible format
  properties:
    method: GET
    path: /api/model
    description: Returns the current model in viewer-compatible format
    responses:
      "200":
        description: Model data
      "404":
        description: Model manifest not found
    x-archimate-ref:
      - application.service.data-loader
    x-protected-by:
      - security.permission.read-model-files
      - security.countermeasure.path-validation
      - security.countermeasure.input-sanitization
    x-response-schema:
      - data_model.object-schema.model-response
    source:
      reference:
        provenance: manual
        locations:
          - file: server/index.cjs
            symbol: getModelHandler
list-changesets:
  id: api.operation.list-changesets
  name: List Changesets
  type: operation
  documentation: Returns a list of all available changesets
  properties:
    method: GET
    path: /api/changesets
    description: Returns a list of all available changesets
    responses:
      "200":
        description: List of changesets
    x-archimate-ref:
      - application.service.yaml-parser
    x-protected-by:
      - security.permission.read-model-files
      - security.countermeasure.path-validation
    x-response-schema:
      - data_model.object-schema.changeset-list
    source:
      reference:
        provenance: manual
        locations:
          - file: server/index.cjs
            symbol: listChangesetsHandler
get-changeset:
  id: api.operation.get-changeset
  name: Get Changeset
  type: operation
  documentation: Returns details for a specific changeset
  properties:
    method: GET
    path: /api/changesets/{changeset_id}
    description: Returns details for a specific changeset
    parameters:
      - name: changeset_id
        in: path
        required: true
        schema:
          type: string
    responses:
      "200":
        description: Changeset details
      "404":
        description: Changeset not found
    x-archimate-ref:
      - application.service.yaml-parser
    x-protected-by:
      - security.permission.read-model-files
      - security.countermeasure.path-validation
      - security.countermeasure.input-sanitization
    x-response-schema:
      - data_model.object-schema.changeset-details
    source:
      reference:
        provenance: manual
        locations:
          - file: server/index.cjs
            symbol: getChangesetHandler
get-annotations:
  id: api.operation.get-annotations
  name: Get Annotations
  type: operation
  documentation: Returns annotations, optionally filtered by element ID
  properties:
    method: GET
    path: /api/annotations
    description: Returns annotations, optionally filtered by element ID
    parameters:
      - name: elementId
        in: query
        required: false
        schema:
          type: string
    responses:
      "200":
        description: List of annotations
    x-archimate-ref:
      - application.service.demo-data-service
    x-protected-by:
      - security.permission.access-api-endpoints
      - security.countermeasure.output-encoding
    x-response-schema:
      - data_model.object-schema.annotation-list
    source:
      reference:
        provenance: manual
        locations:
          - file: server/index.cjs
            symbol: getAnnotationsHandler
get-github-releases:
  id: api.operation.get-github-releases
  name: Get GitHub Releases
  type: operation
  documentation: Fetches all spec releases from GitHub repository
  properties:
    method: GET
    path: /api/github/releases
    description: Fetches all spec releases from GitHub repository
    openapi: 3.0.3
    info:
      title: GitHub Releases API
      version: 1.0.0
    paths:
      /api/github/releases:
        get:
          summary: Fetches all spec releases from GitHub repository
          operationId: getGitHubReleases
          responses:
            "200":
              description: List of releases
              content:
                application/json:
                  schema:
                    type: array
                    items:
                      type: object
                      properties:
                        tag_name:
                          type: string
                        name:
                          type: string
                        assets:
                          type: array
            "500":
              description: Failed to fetch releases
    x-archimate-ref:
      - application.service.git-hub-service
    x-protected-by:
      - security.permission.access-api-endpoints
      - security.countermeasure.input-sanitization
    x-response-schema:
      - data-model.object-schema.github-release-list
    source:
      reference:
        provenance: manual
        locations:
          - file: server/index.cjs
            symbol: getGitHubReleasesHandler
get-latest-github-release:
  id: api.operation.get-latest-github-release
  name: Get Latest GitHub Release
  type: operation
  documentation: Fetches the latest spec release from GitHub
  properties:
    method: GET
    path: /api/github/releases/latest
    description: Fetches the latest spec release from GitHub repository
    openapi: 3.0.3
    info:
      title: GitHub Latest Release API
      version: 1.0.0
    paths:
      /api/github/releases/latest:
        get:
          summary: Fetches the latest spec release
          operationId: getLatestGitHubRelease
          responses:
            "200":
              description: Latest release object
              content:
                application/json:
                  schema:
                    type: object
                    properties:
                      tag_name:
                        type: string
                      name:
                        type: string
                      assets:
                        type: array
            "404":
              description: No spec releases found
            "500":
              description: Failed to fetch release
    x-archimate-ref:
      - application.service.git-hub-service
    x-protected-by:
      - security.permission.access-api-endpoints
      - security.countermeasure.input-sanitization
    x-response-schema:
      - data_model.object-schema.github-release
    source:
      reference:
        provenance: manual
        locations:
          - file: server/index.cjs
            symbol: getLatestReleaseHandler
get-github-release-by-tag:
  id: api.operation.get-github-release-by-tag
  name: Get GitHub Release by Tag
  type: operation
  documentation: Fetches a specific release by tag name from GitHub
  properties:
    method: GET
    path: /api/github/releases/{tag}
    description: Fetches a specific release by tag name from GitHub
    openapi: 3.0.3
    info:
      title: GitHub Release by Tag API
      version: 1.0.0
    paths:
      /api/github/releases/{tag}:
        get:
          summary: Fetches a specific release by tag
          operationId: getGitHubReleaseByTag
          parameters:
            - name: tag
              in: path
              required: true
              schema:
                type: string
          responses:
            "200":
              description: Release object with details and assets
              content:
                application/json:
                  schema:
                    type: object
            "404":
              description: Release not found
            "500":
              description: Failed to fetch release
    x-archimate-ref:
      - application.service.git-hub-service
    x-protected-by:
      - security.permission.access-api-endpoints
      - security.countermeasure.input-sanitization
      - security.countermeasure.path-validation
    x-response-schema:
      - data_model.object-schema.github-release
download-github-schema-zip:
  id: api.operation.download-github-schema-zip
  name: Download GitHub Schema ZIP
  type: operation
  documentation: Proxies download of schema ZIP from GitHub to avoid CORS
  properties:
    method: GET
    path: /api/github/download/{tag}
    description: Proxies download of schema ZIP from GitHub release asset to avoid CORS
    openapi: 3.0.3
    info:
      title: GitHub Schema Download API
      version: 1.0.0
    paths:
      /api/github/download/{tag}:
        get:
          summary: Downloads schema ZIP from GitHub release
          operationId: downloadGitHubSchemaZip
          parameters:
            - name: tag
              in: path
              required: true
              schema:
                type: string
          responses:
            "200":
              description: ZIP file binary stream
              content:
                application/zip:
                  schema:
                    type: string
                    format: binary
            "404":
              description: Release or asset not found
            "500":
              description: Failed to download
    x-archimate-ref:
      - application.service.git-hub-service
    x-protected-by:
      - security.permission.access-api-endpoints
      - security.countermeasure.input-sanitization
get-example-implementation:
  id: api.operation.get-example-implementation
  name: Get Example Implementation
  type: operation
  documentation: Serves the example-implementation model YAML files as JSON
  properties:
    method: GET
    path: /api/example-implementation
    description: Serves the example-implementation model YAML files as JSON
    openapi: 3.0.3
    info:
      title: Example Implementation API
      version: 1.0.0
    paths:
      /api/example-implementation:
        get:
          summary: Serves example implementation model
          operationId: getExampleImplementation
          responses:
            "200":
              description: Dictionary of file paths to YAML content
              content:
                application/json:
                  schema:
                    type: object
                    additionalProperties:
                      type: string
            "404":
              description: Example implementation not found
            "500":
              description: Failed to serve example implementation
    x-archimate-ref:
      - application.service.yaml-parser
      - application.service.data-loader
    x-protected-by:
      - security.permission.access-api-endpoints
      - security.countermeasure.input-sanitization
websocket-connect:
  id: api.operation.websocket-connect
  name: WebSocket Connection
  type: operation
  documentation: Main WebSocket endpoint for live model updates
  properties:
    method: GET
    path: /ws
    protocol: websocket
    description: Main WebSocket endpoint for live updates
    messages:
      server-to-client:
        - connected
        - subscribed
        - pong
        - model.updated
        - changeset.created
        - annotation.added
      client-to-server:
        - subscribe
        - ping
    x-archimate-ref:
      - application.service.reference-server
    x-protected-by:
      - security.permission.websocket-permission
      - security.countermeasure.websocket-origin-validation
      - security.countermeasure.message-validation
    source:
      reference:
        provenance: manual
        locations:
          - file: server/index.cjs
            symbol: websocketHandler
connected:
  id: api.event.connected
  name: Connected Event
  type: operation
  documentation: Sent immediately after WebSocket connection established
  properties:
    direction: server-to-client
    channel: /ws
    description: Sent immediately after connection established
    payload:
      type: connected
      version: string
      timestamp: string
    x-protected-by:
      - security.countermeasure.websocket-origin-validation
    x-payload-schema:
      - data-model.object-schema.websocket-message
subscribe:
  id: api.event.subscribe
  name: Subscribe Command
  type: operation
  documentation: Client request to subscribe to update topics
  properties:
    direction: client-to-server
    channel: /ws
    description: Client request to subscribe to topics
    payload:
      type: subscribe
      topics: array<string>
    x-protected-by:
      - security.countermeasure.websocket-origin-validation
      - security.countermeasure.message-validation
    x-payload-schema:
      - data-model.object-schema.subscribe-message
model-updated:
  id: api.event.model-updated
  name: Model Updated Event
  type: operation
  documentation: Broadcast when the underlying model changes
  properties:
    direction: server-to-client
    channel: /ws
    description: Broadcast when the underlying model changes
    payload:
      type: model.updated
      timestamp: string
    x-payload-schema:
      - data-model.object-schema.model-updated-event
get-link-registry:
  id: api.operation.get-link-registry
  name: Get Link Registry
  type: operation
  documentation: Returns cross-layer link type catalog with validation rules and
    cardinality constraints
  properties:
    method: GET
    path: /api/link-registry
    protocol: rest
    x-archimate-ref:
      - application.service.cross-layer-reference-resolver
    x-response-schema:
      - data_model.object-schema.link-type
create-annotation:
  id: api.operation.create-annotation
  name: Create Annotation
  type: operation
  documentation: Creates new user annotation on model element with author,
    content, and timestamp
  properties:
    method: POST
    path: /api/annotations
    protocol: rest
    x-archimate-ref:
      - application.service.demo-data-service
    x-request-schema:
      - data_model.object-schema.annotation
    x-response-schema:
      - data_model.object-schema.annotation
    source:
      reference:
        provenance: manual
        locations:
          - file: server/index.cjs
            symbol: createAnnotationHandler
changeset-created:
  id: api.operation.changeset-created
  name: Changeset Created Event
  type: operation
  documentation: WebSocket event broadcast when new changeset is created on the server
  properties:
    direction: server-to-client
    channel: /ws
    protocol: websocket
    x-archimate-ref:
      - application.service.yaml-parser
    x-payload-schema:
      - data-model.object-schema.changeset-summary
      - data-model.object-schema.changeset-created-event
annotation-added:
  id: api.operation.annotation-added
  name: Annotation Added Event
  type: operation
  documentation: WebSocket event broadcast when annotation is added to an element by any user
  properties:
    direction: server-to-client
    channel: /ws
    protocol: websocket
    x-archimate-ref:
      - application.service.demo-data-service
    x-payload-schema:
      - data-model.object-schema.annotation
      - data-model.object-schema.annotation-added-event
subscribed:
  id: api.operation.subscribed
  name: Subscribed Event
  type: operation
  documentation: WebSocket confirmation event sent after client subscribes to update topics
  properties:
    direction: server-to-client
    channel: /ws
    protocol: websocket
    x-payload-schema:
      - data-model.object-schema.subscribed-event
pong:
  id: api.operation.pong
  name: Pong Event
  type: operation
  documentation: WebSocket heartbeat response to client ping for connection
    keepalive monitoring
  properties:
    direction: server-to-client
    channel: /ws
    protocol: websocket
    x-payload-schema:
      - data-model.object-schema.pong-message
ping:
  id: api.operation.ping
  name: Ping Command
  type: operation
  documentation: Client WebSocket heartbeat message for connection keepalive
    monitoring and timeout detection
  properties:
    direction: client-to-server
    channel: /ws
    protocol: websocket
    x-payload-schema:
      - data-model.object-schema.ping-message
rest-mode:
  id: api.operation.rest-mode
  name: REST Mode Fallback
  type: operation
  documentation: Client event emitted when WebSocket is unavailable, triggering
    fallback to REST polling
  properties:
    direction: client-event
    protocol: client-side
update-annotation:
  id: api.operation.update-annotation
  name: Update Annotation
  type: operation
  documentation: Updates existing annotation content, author, or resolution status
  properties:
    method: PUT
    path: /api/annotations/{annotation_id}
    protocol: rest
    parameters:
      - name: annotation_id
        in: path
        required: true
        schema:
          type: string
    responses:
      "200":
        description: Annotation updated successfully
      "400":
        description: Invalid annotation data
      "404":
        description: Annotation not found
    x-archimate-ref:
      - application.service.demo-data-service
    x-protected-by:
      - security.permission.access-api-endpoints
    x-request-schema:
      - data_model.object-schema.annotation
    x-response-schema:
      - data_model.object-schema.annotation
delete-annotation:
  id: api.operation.delete-annotation
  name: Delete Annotation
  type: operation
  documentation: Deletes annotation by ID with cascade to related data
  properties:
    method: DELETE
    path: /api/annotations/{annotation_id}
    protocol: rest
    parameters:
      - name: annotation_id
        in: path
        required: true
        schema:
          type: string
    responses:
      "204":
        description: Annotation deleted successfully
      "403":
        description: Insufficient permissions to delete
      "404":
        description: Annotation not found
    x-archimate-ref:
      - application.service.demo-data-service
    x-protected-by:
      - security.permission.access-api-endpoints
create-changeset:
  id: api.operation.create-changeset
  name: Create Changeset
  type: operation
  documentation: Creates new changeset for isolated model modifications
  properties:
    method: POST
    path: /api/changesets
    protocol: rest
    responses:
      "201":
        description: Changeset created successfully
      "400":
        description: Invalid changeset data
    x-archimate-ref:
      - application.service.yaml-parser
    x-protected-by:
      - security.permission.read-model-files
    x-request-schema:
      - data_model.object-schema.changeset-summary
    x-response-schema:
      - data_model.object-schema.changeset-details
apply-changeset:
  id: api.operation.apply-changeset
  name: Apply Changeset
  type: operation
  documentation: Applies changeset to main model and broadcasts update via WebSocket
  properties:
    method: POST
    path: /api/changesets/{changeset_id}/apply
    protocol: rest
    parameters:
      - name: changeset_id
        in: path
        required: true
        schema:
          type: string
    responses:
      "200":
        description: Changeset applied successfully
      "404":
        description: Changeset not found
      "409":
        description: Conflict with current model state
    x-archimate-ref:
      - application.service.yaml-parser
    x-protected-by:
      - security.permission.read-model-files
    x-response-schema:
      - data_model.object-schema.model-response
