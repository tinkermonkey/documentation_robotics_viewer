file-system:
  id: security.secure-resource.file-system
  name: Local File System
  resource: file://model/**
  type: file
  description: >-
    Local file system access for DR model files. Includes the model directory
    containing manifest.yaml, layer directories, and all element YAML files.
    Access is scoped to the model directory only.
  operations:
    - security.resource-operation.read-file
    - security.resource-operation.write-file
  protected-by:
    - security.policy.local-access
  threats:
    - security.threat.path-traversal
    - security.threat.unauthorized-file-access

api-endpoints:
  id: security.secure-resource.api-endpoints
  name: API Endpoints
  resource: /api/**
  type: api
  description: >-
    REST API endpoints for the reference server including model retrieval,
    spec access, health checks, and changeset management. All endpoints
    are currently unauthenticated for local development use.
  operations:
    - security.resource-operation.get-model
    - security.resource-operation.get-spec
    - security.resource-operation.list-changesets
  linked-operations:
    - api.operation.health-check
    - api.operation.get-spec
    - api.operation.get-model
    - api.operation.list-changesets
    - api.operation.get-changeset
    - api.operation.get-annotations
  protected-by:
    - security.policy.local-access

websocket:
  id: security.secure-resource.websocket
  name: WebSocket Connection
  resource: ws://localhost:*/ws
  type: service
  description: >-
    WebSocket connection for real-time model updates and collaboration.
    Used for annotation synchronization, model change notifications,
    and multi-user awareness features.
  operations:
    - security.resource-operation.ws-connect
    - security.resource-operation.ws-subscribe
  linked-operations:
    - api.operation.websocket-connect
    - api.event.connected
    - api.event.subscribe
    - api.event.model-updated
  protected-by:
    - security.policy.local-access
  threats:
    - security.threat.websocket-hijacking
