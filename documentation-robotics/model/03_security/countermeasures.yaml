file-system-sandboxing:
  id: security.countermeasure.file-system-sandboxing
  name: File System Sandboxing
  type: preventive
  description: >-
    Restrict file system access to the designated model directory only.
    All file operations are validated to ensure they remain within the
    allowed directory scope. Uses path resolution and prefix checking.
  effectiveness: high
  implemented: true
  mitigates:
    - security.threat.unauthorized-file-access
    - security.threat.path-traversal
  implementation-notes: >-
    Implemented in data loader service with path validation before any
    file read operations. Uses Node.js path.resolve() to normalize paths
    and verify they start with the allowed base directory.

path-validation:
  id: security.countermeasure.path-validation
  name: Path Validation
  type: preventive
  description: >-
    Validate all file paths to prevent directory traversal attacks. Rejects
    paths containing '../', absolute paths outside allowed directories,
    and symbolic links pointing outside the model directory.
  effectiveness: high
  implemented: true
  mitigates:
    - security.threat.path-traversal
    - security.threat.unauthorized-file-access
  implementation-notes: >-
    Path validation occurs before any file system operation. Includes
    checks for: path traversal sequences, null bytes, and verification
    that resolved path is within allowed directory.

input-sanitization:
  id: security.countermeasure.input-sanitization
  name: Input Sanitization
  type: preventive
  description: >-
    Sanitize all user-provided and model-derived content before rendering
    in the UI. Escapes HTML entities, removes potentially dangerous
    attributes, and validates data against expected schemas.
  effectiveness: high
  implemented: true
  mitigates:
    - security.threat.xss-attack
    - security.threat.path-traversal
  implementation-notes: >-
    React's JSX automatically escapes content. Additional sanitization
    for dangerouslySetInnerHTML usage. YAML parsing validates against
    JSON schemas to reject malformed input.

output-encoding:
  id: security.countermeasure.output-encoding
  name: Output Encoding
  type: preventive
  description: >-
    Encode all dynamic content appropriately for the output context.
    HTML encoding for DOM insertion, URL encoding for links, and
    JavaScript encoding for script contexts.
  effectiveness: high
  implemented: true
  mitigates:
    - security.threat.xss-attack
  implementation-notes: >-
    React handles HTML encoding automatically. SVG export service
    encodes content appropriately. No raw HTML insertion without
    explicit sanitization.

websocket-origin-validation:
  id: security.countermeasure.websocket-origin-validation
  name: WebSocket Origin Validation
  type: preventive
  description: >-
    Validate the origin header of WebSocket connection requests to
    ensure connections only come from allowed sources. Rejects
    cross-origin connection attempts.
  effectiveness: medium
  implemented: false
  mitigates:
    - security.threat.websocket-hijacking
  implementation-notes: >-
    Not currently implemented as application runs locally. Should be
    implemented if deployed as a shared service. Will validate Origin
    header against allowed domains list.

message-validation:
  id: security.countermeasure.message-validation
  name: WebSocket Message Validation
  type: detective
  description: >-
    Validate all incoming WebSocket messages against expected schemas
    before processing. Rejects malformed or unexpected message types
    to prevent injection attacks.
  effectiveness: medium
  implemented: true
  mitigates:
    - security.threat.websocket-hijacking
  implementation-notes: >-
    WebSocket client validates message structure and type before
    dispatching to handlers. Invalid messages are logged and discarded.
